Given a dataset of images, implement an algorithm to train a Generative Adversarial Network (GAN) for image synthesis. The algorithm should include both the generator and discriminator components. The generator should take a random noise vector as input and output an image, while the discriminator should take an image as input and output a probability that the image is real (from the dataset) rather than fake (from the generator). The algorithm should use backpropagation to train the GAN, with the goal of the generator fooling the discriminator into thinking the generated images are real. Consider edge cases such as mode collapse and vanishing gradients.
